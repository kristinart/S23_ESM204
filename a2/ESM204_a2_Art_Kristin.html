<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.323">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kristin Art &amp; Simone Berkovitz">

<title>ESM204_a2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="ESM204_a2_Art_Kristin_files/libs/clipboard/clipboard.min.js"></script>
<script src="ESM204_a2_Art_Kristin_files/libs/quarto-html/quarto.js"></script>
<script src="ESM204_a2_Art_Kristin_files/libs/quarto-html/popper.min.js"></script>
<script src="ESM204_a2_Art_Kristin_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="ESM204_a2_Art_Kristin_files/libs/quarto-html/anchor.min.js"></script>
<link href="ESM204_a2_Art_Kristin_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ESM204_a2_Art_Kristin_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="ESM204_a2_Art_Kristin_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="ESM204_a2_Art_Kristin_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="ESM204_a2_Art_Kristin_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ESM204_a2</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Kristin Art &amp; Simone Berkovitz </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">warning =</span> <span class="cn">FALSE</span>, <span class="at">message =</span> <span class="cn">FALSE</span>, <span class="at">results =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr) </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(equatiomatic)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pracma)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wesanderson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="simulating-carbon-abatement" class="level2">
<h2 class="anchored" data-anchor-id="simulating-carbon-abatement">Simulating Carbon Abatement</h2>
<p>In this assignment, we simulate alternative approaches for reducing carbon emissions among four UC campuses (UCSB, UCLA, UCI, and UCD). We begin with a data set that contains estimates of the marginal cost of reducing carbon emission for each campus for different levels of abatement (in tons of carbon). Note that current (i.e.&nbsp;baseline) emission for each campus are:</p>
<ul>
<li><p>UCSB = 90,000 tons</p></li>
<li><p>UCLA = 250,000 tons</p></li>
<li><p>UCI = 100,000 tons</p></li>
<li><p>UCD = 160,000 tons</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#import data and pivot longer</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>emissions <span class="ot">=</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"a2"</span>,<span class="st">"CarbonUC.csv"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> ucsb<span class="sc">:</span>ucd, <span class="at">names_to =</span> <span class="st">"site"</span>, <span class="at">values_to =</span> <span class="st">"mac"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#define baseline emissions for each campus (all in tons)</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>ucsb_baseline <span class="ot">=</span> <span class="dv">90000</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>ucla_baseline <span class="ot">=</span> <span class="dv">250000</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>uci_baseline <span class="ot">=</span> <span class="dv">100000</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>ucd_baseline <span class="ot">=</span> <span class="dv">160000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="part-1.-marginal-abatement-cost-curves" class="level3">
<h3 class="anchored" data-anchor-id="part-1.-marginal-abatement-cost-curves">Part 1. Marginal Abatement Cost Curves</h3>
<p>First, we plotted the marginal abatement cost (MAC) against the abatement, or emissions reduction, data from the initial data set. Then, we estimated a linear regression model with a zero intercept for each campus; the resulting marginal abatement cost curve equation for each campus is shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot marginal abatement curves</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>plot_1 <span class="ot">=</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(emissions, <span class="fu">aes</span>(<span class="at">x =</span> abatement, <span class="at">y =</span> mac, <span class="at">color =</span> site)) <span class="sc">+</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_abline(slope = ucsb_slope)+</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_colour_manual(values = c("#679289","#9C964A","#FDD262","#D6604D")) +</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span> <span class="fu">wes_palette</span>(<span class="st">"GrandBudapest1"</span>, <span class="at">n =</span> <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Marginal Abatement Cost Curves for UC Campuses"</span>, <span class="at">y =</span> <span class="st">"Marginal Abatement Cost ($/ton of carbon)"</span>, <span class="at">x =</span> <span class="st">"Abatement (tons of carbon)"</span>, <span class="at">color =</span> <span class="st">"Campus"</span>) <span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">700</span>) </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>plot_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ESM204_a2_Art_Kristin_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#estimate linear regression models with a forced 0 intercept, and extract/save model slopes</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>ucsb_lm <span class="ot">=</span> <span class="fu">lm</span>(mac <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> abatement, <span class="at">data =</span> emissions <span class="sc">%&gt;%</span> <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"ucsb"</span>)) </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>ucsb_slope <span class="ot">=</span> ucsb_lm<span class="sc">$</span>coefficient <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>()</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>ucla_lm <span class="ot">=</span> <span class="fu">lm</span>(mac <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> abatement, <span class="at">data =</span> emissions <span class="sc">%&gt;%</span> <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"ucla"</span>)) </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>ucla_slope <span class="ot">=</span> ucla_lm<span class="sc">$</span>coefficient <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>()</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>uci_lm <span class="ot">=</span> <span class="fu">lm</span>(mac <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> abatement, <span class="at">data =</span> emissions <span class="sc">%&gt;%</span> <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"uci"</span>)) </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>uci_slope <span class="ot">=</span> uci_lm<span class="sc">$</span>coefficient <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>()</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>ucd_lm <span class="ot">=</span> <span class="fu">lm</span>(mac <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> abatement, <span class="at">data =</span> emissions <span class="sc">%&gt;%</span> <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"ucd"</span>)) </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>ucd_slope <span class="ot">=</span> ucd_lm<span class="sc">$</span>coefficient <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>()</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">#add baselines and slopes to full df</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>emissions_mod <span class="ot">=</span> emissions <span class="sc">%&gt;%</span>   </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">baseline =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>      site <span class="sc">==</span> <span class="st">'ucsb'</span> <span class="sc">~</span> ucsb_baseline,</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>      site <span class="sc">==</span> <span class="st">'ucla'</span> <span class="sc">~</span> ucla_baseline,</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>      site <span class="sc">==</span> <span class="st">'uci'</span> <span class="sc">~</span> uci_baseline,</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>      site <span class="sc">==</span> <span class="st">'ucd'</span> <span class="sc">~</span> ucd_baseline),</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">slope =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>      site <span class="sc">==</span> <span class="st">'ucsb'</span> <span class="sc">~</span> ucsb_slope,</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>      site <span class="sc">==</span> <span class="st">'ucla'</span> <span class="sc">~</span> ucla_slope,</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>      site <span class="sc">==</span> <span class="st">'uci'</span> <span class="sc">~</span> uci_slope,</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>      site <span class="sc">==</span> <span class="st">'ucd'</span> <span class="sc">~</span> ucd_slope))</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="co">#write out the MAC curve equations</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="co">#UCSB MAC:</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>equatiomatic<span class="sc">::</span><span class="fu">extract_eq</span>(ucsb_lm, <span class="at">use_coefs =</span> <span class="cn">TRUE</span>, <span class="at">coef_digits =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
\operatorname{\widehat{mac}} = 0.0010042(\operatorname{abatement})
\]</span></p>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#UCLA MAC:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>equatiomatic<span class="sc">::</span><span class="fu">extract_eq</span>(ucla_lm, <span class="at">use_coefs =</span> <span class="cn">TRUE</span>, <span class="at">coef_digits =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
\operatorname{\widehat{mac}} = 0.00070143(\operatorname{abatement})
\]</span></p>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#UCD MAC:</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>equatiomatic<span class="sc">::</span><span class="fu">extract_eq</span>(ucd_lm, <span class="at">use_coefs =</span> <span class="cn">TRUE</span>, <span class="at">coef_digits =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
\operatorname{\widehat{mac}} = 0.00302414(\operatorname{abatement})
\]</span></p>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#UCI MAC:</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>equatiomatic<span class="sc">::</span><span class="fu">extract_eq</span>(uci_lm, <span class="at">use_coefs =</span> <span class="cn">TRUE</span>, <span class="at">coef_digits =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
\operatorname{\widehat{mac}} = 0.00200773(\operatorname{abatement})
\]</span></p>
</div>
</div>
</section>
<section id="part-2.-demand-curves" class="level3">
<h3 class="anchored" data-anchor-id="part-2.-demand-curves">Part 2. Demand Curves</h3>
<p>Next, we derived each campus’ demand curve for carbon using the estimated MAC curves and known baseline emissions. We plotted those curves and saw that UCD is willing to pay the most for the first ton of carbon emissions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#define generic demand function to solve for P</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>compute_demand_P <span class="ot">=</span> <span class="cf">function</span>(slope, baseline, emissions){</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  demand <span class="ot">=</span> slope<span class="sc">*</span>(baseline <span class="sc">-</span> emissions)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(demand)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">#apply demand function and save results in main df</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>emissions_mod <span class="ot">=</span> emissions_mod <span class="sc">%&gt;%</span> </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">demand =</span> <span class="fu">compute_demand_P</span>(slope, baseline, abatement))</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#create linear models of demand (not necessary)</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>ucsb_d_df <span class="ot">=</span> emissions_mod <span class="sc">%&gt;%</span> </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"ucsb"</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>ucsb_d_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(demand <span class="sc">~</span> abatement, <span class="at">data =</span> ucsb_d_df)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>ucla_d_df <span class="ot">=</span> emissions_mod <span class="sc">%&gt;%</span> </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"ucla"</span>)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>ucla_d_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(demand <span class="sc">~</span> abatement, <span class="at">data =</span> ucla_d_df)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>uci_d_df <span class="ot">=</span> emissions_mod <span class="sc">%&gt;%</span> </span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"uci"</span>)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>uci_d_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(demand <span class="sc">~</span> abatement, <span class="at">data =</span> uci_d_df)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>ucd_d_df <span class="ot">=</span> emissions_mod <span class="sc">%&gt;%</span> </span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"ucd"</span>)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>ucd_d_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(demand <span class="sc">~</span> abatement, <span class="at">data =</span> ucd_d_df)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="co">#write out the demand equations</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="co">#UCSB demand curve</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>equatiomatic<span class="sc">::</span><span class="fu">extract_eq</span>(ucsb_d_lm, <span class="at">use_coefs =</span> <span class="cn">TRUE</span>, <span class="at">coef_digits =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
\operatorname{\widehat{demand}} = 90.37812564 - 0.0010042(\operatorname{abatement})
\]</span></p>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#UCLA demand curve</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>equatiomatic<span class="sc">::</span><span class="fu">extract_eq</span>(ucla_d_lm, <span class="at">use_coefs =</span> <span class="cn">TRUE</span>, <span class="at">coef_digits =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
\operatorname{\widehat{demand}} = 175.35868703 - 0.00070143(\operatorname{abatement})
\]</span></p>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#UCD demand curve</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>equatiomatic<span class="sc">::</span><span class="fu">extract_eq</span>(ucd_d_lm, <span class="at">use_coefs =</span> <span class="cn">TRUE</span>, <span class="at">coef_digits =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
\operatorname{\widehat{demand}} = 483.86272388 - 0.00302414(\operatorname{abatement})
\]</span></p>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#UCI demand curve</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>equatiomatic<span class="sc">::</span><span class="fu">extract_eq</span>(uci_d_lm, <span class="at">use_coefs =</span> <span class="cn">TRUE</span>, <span class="at">coef_digits =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
\operatorname{\widehat{demand}} = 200.77288765 - 0.00200773(\operatorname{abatement})
\]</span></p>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot demand curve for all sites</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>plot_2 <span class="ot">=</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(emissions_mod, <span class="fu">aes</span>(<span class="at">x =</span> abatement, <span class="at">y =</span> demand, <span class="at">color =</span> site)) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_colour_manual(values = c("#679289","#9C964A","#FDD262","#D6604D")) +</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span> <span class="fu">wes_palette</span>(<span class="st">"GrandBudapest1"</span>, <span class="at">n =</span> <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Pollution (tons of carbon)"</span>, <span class="at">y =</span>  <span class="st">"Demand ($/ ton of carbon )"</span>, <span class="at">color =</span> <span class="st">"Campus"</span>, <span class="at">title =</span> <span class="st">"Demand Curves for UC Campuses"</span>) <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>()<span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">500</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>plot_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ESM204_a2_Art_Kristin_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="part-3.-interventions" class="level3">
<h3 class="anchored" data-anchor-id="part-3.-interventions">Part 3. Interventions</h3>
<p>Next, we analyzed four alternative interventions for reducing carbon emissions across these four campuses.</p>
<section id="a.-intervention-1-carbon-tax" class="level4">
<h4 class="anchored" data-anchor-id="a.-intervention-1-carbon-tax">a. Intervention #1: Carbon Tax</h4>
<p>Under this intervention, each campus must pay a tax of $50/ton for each ton of emissions.</p>
<p>Under this policy, each campus would choose to emit the following quantities of carbon:</p>
<ul>
<li><p>UCSB: 40,209 tons CO2</p></li>
<li><p>UCLA: 178,718 tons CO2</p></li>
<li><p>UCD: 143,466 tons CO2</p></li>
<li><p>UCI: 75,096 tons CO2</p></li>
</ul>
<p>Under this policy, each campus would choose to abate the following quantities of carbon:</p>
<ul>
<li><p>UCSB: 49,491 tons CO2</p></li>
<li><p>UCLA: 71,282 tons CO2</p></li>
<li><p>UCD: 16,534 tons CO2</p></li>
<li><p>UCI: 24,904 tons CO2</p></li>
</ul>
<p>The total amount of emissions across all four campuses is 437,489.3 tons of CO2 and the total tax revenue generated is $21,874,467.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#define generic function to calculate abatement Q</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>compute_demand_Q <span class="ot">=</span> <span class="cf">function</span>(slope, baseline, price){</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  Q <span class="ot">=</span> baseline <span class="sc">-</span> ((price)<span class="sc">/</span>(slope))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Q)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#define generic function to calculate abatement Q</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>compute_abatement_Q <span class="ot">=</span> <span class="cf">function</span>(baseline, emit_Q){</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  abatement_Q <span class="ot">=</span> baseline <span class="sc">-</span> emit_Q</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(abatement_Q)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate the quantity emitted and abated by each campus</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>ucsb_emit_Q <span class="ot">=</span> <span class="fu">compute_demand_Q</span>(ucsb_slope, ucsb_baseline, <span class="at">price =</span> <span class="dv">50</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>ucsb_abate_Q <span class="ot">=</span> <span class="fu">compute_abatement_Q</span>(ucsb_baseline, ucsb_emit_Q)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Under intervention #1 (carbon tax), UCSB will emit "</span> , ucsb_emit_Q, <span class="st">" tons of carbon and abate "</span>, ucsb_abate_Q, <span class="st">" tons of carbon."</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Under intervention #1 (carbon tax), UCSB will emit 40209.1909084787 tons of carbon and abate 49790.8090915213 tons of carbon."</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>ucla_emit_Q <span class="ot">=</span> <span class="fu">compute_demand_Q</span>(ucla_slope, ucla_baseline, <span class="at">price =</span> <span class="dv">50</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>ucla_abate_Q <span class="ot">=</span> <span class="fu">compute_abatement_Q</span>(ucla_baseline, ucla_emit_Q)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Under intervention #1 (carbon tax), UCLA will emit "</span> , ucla_emit_Q, <span class="st">" tons of carbon and abate "</span>, ucla_abate_Q, <span class="st">" tons of carbon."</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Under intervention #1 (carbon tax), UCLA will emit 178717.531983001 tons of carbon and abate 71282.4680169989 tons of carbon."</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ucd_emit_Q <span class="ot">=</span> <span class="fu">compute_demand_Q</span>(ucd_slope, ucd_baseline, <span class="at">price =</span> <span class="dv">50</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>ucd_abate_Q <span class="ot">=</span> <span class="fu">compute_abatement_Q</span>(ucd_baseline, ucd_emit_Q)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Under intervention #1 (carbon tax), UCD will emit "</span> , ucd_emit_Q, <span class="st">" tons of carbon and abate "</span>, ucd_abate_Q, <span class="st">" tons of carbon."</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Under intervention #1 (carbon tax), UCD will emit 143466.384978117 tons of carbon and abate 16533.6150218829 tons of carbon."</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>uci_emit_Q <span class="ot">=</span> <span class="fu">compute_demand_Q</span>(uci_slope, uci_baseline, <span class="at">price =</span> <span class="dv">50</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>uci_abate_Q <span class="ot">=</span> <span class="fu">compute_abatement_Q</span>(uci_baseline, uci_emit_Q)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Under intervention #1 (carbon tax), UCI will emit "</span> , uci_emit_Q, <span class="st">" tons of carbon and abate "</span>, uci_abate_Q, <span class="st">" tons of carbon."</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Under intervention #1 (carbon tax), UCI will emit 75096.2390467848 tons of carbon and abate 24903.7609532152 tons of carbon."</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate the total quantity emitted and total tax revenue generated</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>total_emitted <span class="ot">=</span> <span class="fu">sum</span>(ucsb_emit_Q, ucla_emit_Q, uci_emit_Q, ucd_emit_Q)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>total_revenue <span class="ot">=</span> total_emitted<span class="sc">*</span><span class="dv">50</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Under intervention #1 (carbon tax), the four campuses will emit a total of "</span> , total_emitted, <span class="st">" tons of carbon and generate $"</span>, total_revenue, <span class="st">" in tax revenue."</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Under intervention #1 (carbon tax), the four campuses will emit a total of 437489.346916382 tons of carbon and generate $21874467.3458191 in tax revenue."</code></pre>
</div>
</div>
</section>
<section id="b.-intervention-2-carbon-ban" class="level4">
<h4 class="anchored" data-anchor-id="b.-intervention-2-carbon-ban">b. Intervention #2: Carbon Ban</h4>
<p>Under this intervention, carbon emissions are banned at each campus. The total cost of this ban to each campus would be as follows:</p>
<ul>
<li><p>UCSB: $4,067,016</p></li>
<li><p>UCLA: $21,919,836</p></li>
<li><p>UCD: $38,709,018</p></li>
<li><p>UCI: $10,038,644</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#define individual supply functions to solve for P</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>ucsb_mac_P <span class="ot">=</span> <span class="cf">function</span>(Q){</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  P <span class="ot">=</span> ucsb_slope<span class="sc">*</span>Q</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(P)}</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>ucla_mac_P <span class="ot">=</span> <span class="cf">function</span>(Q){</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  P <span class="ot">=</span> ucla_slope<span class="sc">*</span>Q</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(P)}</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>ucd_mac_P <span class="ot">=</span> <span class="cf">function</span>(Q){</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  P <span class="ot">=</span> ucd_slope<span class="sc">*</span>Q</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(P)}</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>uci_mac_P <span class="ot">=</span> <span class="cf">function</span>(Q){</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  P <span class="ot">=</span> uci_slope<span class="sc">*</span>Q</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(P)}</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate the cost of the ban for each campus</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>ucsb_ban_P <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">integral</span>(<span class="at">f =</span> ucsb_mac_P, <span class="at">xmin =</span> ucsb_baseline, <span class="at">xmax =</span> <span class="dv">0</span>))</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>ucla_ban_P <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">integral</span>(<span class="at">f =</span> ucla_mac_P, <span class="at">xmin =</span> ucla_baseline, <span class="at">xmax =</span> <span class="dv">0</span>))</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>ucd_ban_P <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">integral</span>(<span class="at">f =</span> ucd_mac_P, <span class="at">xmin =</span> ucd_baseline, <span class="at">xmax =</span> <span class="dv">0</span>))</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>uci_ban_P <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">integral</span>(<span class="at">f =</span> uci_mac_P, <span class="at">xmin =</span> uci_baseline, <span class="at">xmax =</span> <span class="dv">0</span>))</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate the total cost for all 4 campuses</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>total_ban_P <span class="ot">=</span> <span class="fu">sum</span>(ucsb_ban_P, ucla_ban_P, ucd_ban_P, uci_ban_P)</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Intervention #2 (carbon ban) will cost $"</span>, ucsb_ban_P,<span class="st">" at UCSB, $"</span>, ucla_ban_P, <span class="st">" at UCLA, $"</span>, ucd_ban_P, <span class="st">" at UCD, and $"</span>, uci_ban_P, <span class="st">"at UCI. The total cost to all four campuses is $"</span>, total_ban_P, <span class="st">"."</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Intervention #2 (carbon ban) will cost $4067015.6539891 at UCSB, $21919835.8792429 at UCLA, $38709017.9100539 at UCD, and $10038644.3826559at UCI. The total cost to all four campuses is $74734513.8259418."</code></pre>
</div>
</div>
</section>
<section id="c.-intervention-3-cap-without-trade" class="level4">
<h4 class="anchored" data-anchor-id="c.-intervention-3-cap-without-trade">c.&nbsp;Intervention #3: Cap without Trade</h4>
<p>Under this intervention, each campus is restricted to an emissions cap of 100,000 tons of carbon. Each campus would need to abate the following quantities of carbon to comply with this cap:</p>
<ul>
<li><p>UCSB: 0 tons CO2</p></li>
<li><p>UCLA: 150,000 tons CO2</p></li>
<li><p>UCD: 60,000 tons CO2</p></li>
<li><p>UCI: 0 tons CO2</p></li>
</ul>
<p>The marginal cost of the last unit of abatement for each campus to comply is:</p>
<ul>
<li><p>UCSB: $0</p></li>
<li><p>UCLA: $105</p></li>
<li><p>UCD: $181</p></li>
<li><p>UCI: $0</p></li>
</ul>
<p>The total cost of abatement for each campus to comply is:</p>
<ul>
<li><p>UCSB: $0</p></li>
<li><p>UCLA: $18,412,662</p></li>
<li><p>UCD: $23,588,308</p></li>
<li><p>UCI: $0</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#apply generic abatement function from above to calculate abatement Q </span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>cap_Q <span class="ot">=</span> <span class="dv">100000</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate quantity abated for each campus</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>ucsb_abate_Q2 <span class="ot">=</span> <span class="fu">max</span>(<span class="dv">0</span>,<span class="fu">compute_abatement_Q</span>(ucsb_baseline, cap_Q))</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>ucla_abate_Q2 <span class="ot">=</span> <span class="fu">max</span>(<span class="dv">0</span>,<span class="fu">compute_abatement_Q</span>(ucla_baseline, cap_Q))</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>ucd_abate_Q2 <span class="ot">=</span> <span class="fu">max</span>(<span class="dv">0</span>,<span class="fu">compute_abatement_Q</span>(ucd_baseline, cap_Q))</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>uci_abate_Q2 <span class="ot">=</span> <span class="fu">max</span>(<span class="dv">0</span>,<span class="fu">compute_abatement_Q</span>(uci_baseline, cap_Q))</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Under intervention #3 (cap without trade), UCSB will abate "</span>, ucsb_abate_Q2, <span class="st">", UCLA will abate "</span>, ucla_abate_Q2, <span class="st">", UCD will abate "</span>, ucd_abate_Q2, <span class="st">", and UCI will abate "</span>, uci_abate_Q2,<span class="st">"."</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Under intervention #3 (cap without trade), UCSB will abate 0, UCLA will abate 150000, UCD will abate 60000, and UCI will abate 0."</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate marginal cost of the last unit of abatement for each campus</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>ucsb_cap_P <span class="ot">=</span> <span class="fu">ucsb_mac_P</span>(ucsb_abate_Q2)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>ucla_cap_P <span class="ot">=</span> <span class="fu">ucla_mac_P</span>(ucla_abate_Q2)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>ucd_cap_P <span class="ot">=</span> <span class="fu">ucd_mac_P</span>(ucd_abate_Q2)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>uci_cap_P <span class="ot">=</span> <span class="fu">uci_mac_P</span>(uci_abate_Q2 )</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Under intervention #3 (cap without trade), the cost of the last unit of abatement for each campus will be $"</span>, ucsb_cap_P, <span class="st">" for UCSB, $"</span>, ucla_cap_P, <span class="st">" for UCLA, $"</span>, ucd_cap_P, <span class="st">" for UCD, and $"</span>, uci_cap_P,<span class="st">" for UCD."</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Under intervention #3 (cap without trade), the cost of the last unit of abatement for each campus will be $0 for UCSB, $105.215212220366 for UCLA, $181.448521453377 for UCD, and $0 for UCD."</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate total cost of abatement for each campus </span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>ucsb_cap_P2 <span class="ot">=</span> <span class="fu">max</span>(<span class="dv">0</span>,(<span class="fu">integral</span>(<span class="at">f =</span> ucsb_mac_P, <span class="at">xmin =</span> cap_Q, <span class="at">xmax =</span> ucsb_baseline)))</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>ucla_cap_P2 <span class="ot">=</span> <span class="fu">max</span>(<span class="dv">0</span>,(<span class="fu">integral</span>(<span class="at">f =</span> ucla_mac_P, <span class="at">xmin =</span> cap_Q, <span class="at">xmax =</span> ucla_baseline)))</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>ucd_cap_P2 <span class="ot">=</span> <span class="fu">max</span>(<span class="dv">0</span>,(<span class="fu">integral</span>(<span class="at">f =</span> ucd_mac_P, <span class="at">xmin =</span> cap_Q, <span class="at">xmax =</span> ucd_baseline)))</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>uci_cap_P2 <span class="ot">=</span> <span class="fu">max</span>(<span class="dv">0</span>,(<span class="fu">integral</span>(<span class="at">f =</span> uci_mac_P, <span class="at">xmin =</span> cap_Q, <span class="at">xmax =</span> uci_baseline)))</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Under intervention #3 (cap without trade), the total cost for each campus to comply with the cap is $"</span>, ucsb_cap_P2, <span class="st">" for UCSB, $"</span>, ucla_cap_P2, <span class="st">" for UCLA, $"</span>, ucd_cap_P2, <span class="st">" for UCD, and $"</span>, uci_cap_P2,<span class="st">" for UCD."</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Under intervention #3 (cap without trade), the total cost for each campus to comply with the cap is $0 for UCSB, $18412662.1385641 for UCLA, $23588307.7889391 for UCD, and $0 for UCD."</code></pre>
</div>
</div>
</section>
<section id="d.-intervention-4-cap-with-trade" class="level4">
<h4 class="anchored" data-anchor-id="d.-intervention-4-cap-with-trade">d.&nbsp;Intervention #4: Cap with Trade</h4>
<p>Under this intervention, each campus is restricted to an emissions cap of 100,000 tons of carbon, but trade is allowed. With trade, total emissions will be 400,000 tons of carbon, but some campuses may emit more or less than 100,000. Under this intervention, the equilibrium trading price of carbon permits after trade would be $61.53/ ton. After trade, each campus would emit the following quantities of carbon:</p>
<ul>
<li><p>UCSB: 28,723 tons CO2</p></li>
<li><p>UCLA: 162,273 tons CO2</p></li>
<li><p>UCD: 139,652 tons CO2</p></li>
<li><p>UCI: 69,351 tons CO2</p></li>
</ul>
<p>UCSB and UCI would be sellers of carbon permits while UCLA and UCD would be buyers of carbon permits under this scenario.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#define individual demand functions to solve for Q</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>ucsb_d_Q <span class="ot">=</span> <span class="cf">function</span>(P){</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  Q <span class="ot">=</span> (((ucsb_slope<span class="sc">*</span>ucsb_baseline) <span class="sc">-</span> P)<span class="sc">/</span> ucsb_slope)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Q)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>ucla_d_Q <span class="ot">=</span> <span class="cf">function</span>(P){</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  Q <span class="ot">=</span> (((ucla_slope<span class="sc">*</span>ucla_baseline) <span class="sc">-</span> P)<span class="sc">/</span> ucla_slope)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Q)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>ucd_d_Q <span class="ot">=</span> <span class="cf">function</span>(P){</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  Q <span class="ot">=</span> (((ucd_slope<span class="sc">*</span>ucd_baseline) <span class="sc">-</span> P)<span class="sc">/</span> ucd_slope)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Q)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>uci_d_Q <span class="ot">=</span> <span class="cf">function</span>(P){</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  Q <span class="ot">=</span> (((uci_slope<span class="sc">*</span>uci_baseline) <span class="sc">-</span> P)<span class="sc">/</span> uci_slope)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Q)</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a><span class="co">#define function to calculate aggregate demand curve and solve for Q</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>agg_d_Q <span class="ot">=</span> <span class="cf">function</span>(P){</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>  Q <span class="ot">=</span> (((ucsb_slope<span class="sc">*</span>ucsb_baseline) <span class="sc">-</span> P)<span class="sc">/</span> ucsb_slope) <span class="sc">+</span> (((ucla_slope<span class="sc">*</span>ucla_baseline) <span class="sc">-</span> P)<span class="sc">/</span> ucla_slope) <span class="sc">+</span> (((ucd_slope<span class="sc">*</span>ucd_baseline) <span class="sc">-</span> P)<span class="sc">/</span> ucd_slope) <span class="sc">+</span> (((uci_slope<span class="sc">*</span>uci_baseline) <span class="sc">-</span> P)<span class="sc">/</span> uci_slope)</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Q)</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a><span class="co">#find total baseline emissions and slope for all 4 campuses to rearrange aggregate demand curve below</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>total_baseline <span class="ot">=</span> <span class="fu">sum</span>(ucsb_baseline, ucla_baseline, ucd_baseline, uci_baseline)</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>total_slope <span class="ot">=</span> ((<span class="dv">1</span><span class="sc">/</span>ucsb_slope) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">/</span>ucla_slope) <span class="sc">+</span>(<span class="dv">1</span><span class="sc">/</span>uci_slope)<span class="sc">+</span>(<span class="dv">1</span><span class="sc">/</span>ucd_slope))</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a><span class="co">#define function to calculate aggregate demand curve and solve for P</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>agg_d_P <span class="ot">=</span> <span class="cf">function</span>(Q){</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>  P <span class="ot">=</span> ((total_baseline <span class="sc">-</span> Q)<span class="sc">/</span>total_slope)</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(P)</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate the equilibrium trading price</span></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>cap_trade_Q <span class="ot">=</span> <span class="dv">400000</span></span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>cap_trade_P <span class="ot">=</span> <span class="fu">agg_d_P</span>(cap_trade_Q)</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate quantity emitted by each campus after trade and compare to cap value ($100,000) to determine who is a seller and who is a buyer</span></span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>ucsb_cap_Q <span class="ot">=</span> <span class="fu">ucsb_d_Q</span>(cap_trade_P)</span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>ucla_cap_Q <span class="ot">=</span> <span class="fu">ucla_d_Q</span>(cap_trade_P)</span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>ucd_cap_Q <span class="ot">=</span> <span class="fu">ucd_d_Q</span>(cap_trade_P)</span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>uci_cap_Q <span class="ot">=</span> <span class="fu">uci_d_Q</span>(cap_trade_P)</span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a><span class="co">#check that this is equal to the total cap, 400,000</span></span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a>total_Q <span class="ot">=</span> <span class="fu">sum</span>(ucsb_cap_Q, ucla_cap_Q, ucd_cap_Q, uci_cap_Q)</span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_Q <span class="sc">==</span> cap_trade_Q)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Under intervention #4 (cap with trade) where the total cap is set at 400,000, the equilibrium trading price of permits after trade would be "</span>, cap_trade_P, <span class="st">". Under this scenario, UCSB will emit "</span>, ucsb_cap_Q, <span class="st">" tons of carbon, UCLA will emit "</span>, ucla_cap_Q, <span class="st">" tons of carbon, UCD will emit "</span>, ucd_cap_Q, <span class="st">" tons of carbon, and UCI will emit "</span>, uci_cap_Q,<span class="st">" tons of carbon. UCSB and UCI are sellers of carbon emission permits while UCLA and UCD are buyers of carbon emissions permits in this market."</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Under intervention #4 (cap with trade) where the total cap is set at 400,000, the equilibrium trading price of permits after trade would be 61.5344274990674. Under this scenario, UCSB will emit 28723.0213567576 tons of carbon, UCLA will emit 162273.482797068 tons of carbon, UCD will emit 139652.269302769 tons of carbon, and UCI will emit 69351.2265434054 tons of carbon. UCSB and UCI are sellers of carbon emission permits while UCLA and UCD are buyers of carbon emissions permits in this market."</code></pre>
</div>
</div>
</section>
</section>
<section id="part-4.-philanthropy-and-cap-trade" class="level3">
<h3 class="anchored" data-anchor-id="part-4.-philanthropy-and-cap-trade">Part 4. Philanthropy and Cap &amp; Trade</h3>
<p>Next, we analyzed what would happen if the central campus decides to go with the “Cap with Trade” approach (Intervention #4 above) and an altruistic philanthropist buys and retires a portion of the available permits. That philanthropist would pay a total of $3,076,721 to purchase and retire 50,000 permits at the equilibrium trading price from above. With the reduced cap of 350,000 permits, the new trading price among the four campuses would be $76.92.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate the new trading price for the 4 campuses</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>cap_trade_Q2 <span class="ot">=</span> <span class="dv">350000</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>cap_trade_P2 <span class="ot">=</span> <span class="fu">agg_d_P</span>(cap_trade_Q2)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>cap_trade_P2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 76.91803</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate the cost for the philanthropist How much will it cost the philanthropist to buy and retire these permits?</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>phil_cost <span class="ot">=</span> <span class="dv">50000</span><span class="sc">*</span>cap_trade_P</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>phil_cost</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3076721</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"A philanthropist will have to pay $"</span>, phil_cost, <span class="st">" to purchase 50,000 of the permits under intervention #4 (cap with trade). The new trading price for the 4 campuses will be "</span>, cap_trade_P2, <span class="st">" with the reduced total emissions cap of 350,000 tons of carbon."</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "A philanthropist will have to pay $3076721.37495337 to purchase 50,000 of the permits under intervention #4 (cap with trade). The new trading price for the 4 campuses will be 76.9180343738342 with the reduced total emissions cap of 350,000 tons of carbon."</code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>